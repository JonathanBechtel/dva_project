<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Force Simulation - DTW</title>
  <style> body { margin: 0; } </style>

  <script src="//unpkg.com/three"></script>
  <script src="//unpkg.com/3d-force-graph"></script>
  <script src="//unpkg.com/three-spritetext"></script>
 


  <style>
    .node-label {
      font-size: 12px;
      padding: 1px 4px;
      border-radius: 4px;
      background-color: rgba(0,0,0,0.3);
      user-select: none;
    }
  </style>

</head>

<body>
  <h1>DTW Graph</h1>
  <div id="3d-graph"></div>

  <script type="importmap">{ "imports": { "three": "https://unpkg.com/three/build/three.module.js" }}</script>
  <script type="module">
    import { CSS2DRenderer, CSS2DObject } from '//unpkg.com/three/examples/jsm/renderers/CSS2DRenderer.js';

    const Graph = ForceGraph3D({
      extraRenderers: [new CSS2DRenderer()]
    })
    (document.getElementById('3d-graph'))
      .jsonUrl('data_corr.json')
      .nodeAutoColorBy('group')
      .nodeVal('sum')
      .nodeThreeObject(node => {
        const nodeEl = document.createElement('div');
        nodeEl.textContent = node.id;
        nodeEl.style.color = node.color;
        nodeEl.className = 'node-label';
        return new CSS2DObject(nodeEl);
      })
      .nodeThreeObjectExtend(true)
      .onNodeClick(node => {
          // Aim at node from outside it
          const distance = 40;
          const distRatio = 1 + distance/Math.hypot(node.x, node.y, node.z);

          const newPos = node.x || node.y || node.z
            ? { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }
            : { x: 0, y: 0, z: distance }; // special case if node is in (0,0,0)

          Graph.cameraPosition(
            newPos, // new position
            node, // lookAt ({ x, y, z })
            3000  // ms transition duration
          );
        });
    ;

    Graph.d3Force('charge').strength(-500);


    

  </script>
</body>
  
<!-- <script>

const Graph = ForceGraph3D()
  (document.getElementById('3d-graph'))
  .jsonUrl('data_corr.json')
  .nodeLabel('id')
  .nodeAutoColorBy('group')
  .nodeThreeObject(node => {
          const sprite = new SpriteText(node.id);
          sprite.material.depthWrite = false; // make sprite background transparent
          sprite.color = node.color;
          sprite.textHeight = 8;
          return sprite;
        });
  
  


  // fit to canvas when engine stops
  // Graph.onEngineStop(() => Graph.zoomToFit(400));


</script>
</body> -->
</html>
